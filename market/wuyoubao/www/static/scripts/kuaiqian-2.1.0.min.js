var kuaiqian=_kuaiqian=KQB=function(win,doc,undef){function uniqueID(n){return(n||"cb_")+[guid++]}function registerHandler(n){var a=uniqueID();return callbacks[a]=n,a}function isType(n,a){return toString.call(a)===TO_STRING_PREFIX+n+"]"}function extend(n,a){for(var e in a)hasOwn.call(a,e)&&(n[e]=a[e]);return n}function constructFuncStr(n){return n+': function ( params ) { native( "'+n+'", params ); }'}function callbackHandler(n,a){var e=callbacks[n];e!==undef&&(isType("Function",e)&&e(a),delete callbacks[n])}function log(n,a){function e(n,a){win.debug}e(n,a)}function setProtocol(n){isType("String",n)&&(PROTOCOL=n)}var guid=0,callbacks={},stringify=JSON.stringify,parse=JSON.parse,hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString,TO_STRING_PREFIX="[object ";if(!win.KQB){var Env=function(){function n(n){return n=n.toLowerCase(),a.indexOf(n)>-1}var a=navigator.userAgent.toLowerCase();return{iOS:n("iphone")||n("ipad")||n("ipod"),Android:n("android"),KQ:n("kuaiqianbao"),FeiFan:n("feifan"),KQSDK:n("kuaiqianpaysdk"),FFTSDK:n("fftpaysdk"),Weixin:n("micromessenger"),is:n}}(),PROTOCOL=function(){var n="bill99app://kuaiqianbao/",a="bill99app://kuaiqianpaysdk/",e="bill99tofeifan://kuaiqianbao/",i="bill99tofeifan://feifantongsdk/";return Env.FeiFan?e:Env.KQSDK?a:Env.FFTSDK?i:n}(),iOS={invoke:function(n,a){var e=iOS.createMessage(n,a);log("invoke","JS鍙戦€佸弬鏁颁负锛�"+e),iOS.sendMessage(e)},createMessage:function(n,a){var e=PROTOCOL+n+"?"+this.parseParam(a);return e},parseParam:function(n){var a={};return a.paramJson=n,a.successCallbackId=n.success&&registerHandler(n.success),a.errorCallBackId=n.error&&registerHandler(n.error),stringify(a)},sendMessage:function(n){var a=doc.createElement("iframe");a.style.cssText="display:none;width:1px;height:1px;",a.src=n;var e=doc.body||doc.documentElement;e.appendChild(a),setTimeout(function(){a.parentNode.removeChild(a)},100)},callback:function(n){log("callback","Native杩斿洖鍙傛暟涓猴細"+stringify(n)),callbackHandler(n.callbackId,n)}},Android={invoke:function(n,a){var e=Android.createMessage(n,a);log("invoke","JS鍙戦€佸弬鏁颁负锛�"+e),Android.sendMessage(e)},createMessage:function(n,a){var e={functionName:n,params:a};return a.success&&(e.params.successCallbackId=registerHandler(a.success)),a.error&&(e.params.errorCallbackId=registerHandler(a.error)),stringify(e)},sendMessage:function(n){win._jsBridge&&_jsBridge.sendMessage(n)},callback:function(n){log("callback","Native杩斿洖鍙傛暟涓猴細"+stringify(n)),n=parse(n),callbackHandler(n.callbackId,n.result)}},invoke=function(){return Env.iOS?iOS.invoke:Env.Android?Android.invoke:!1}(),callback=function(){return Env.Android||Env.FeiFan?Android.callback:Env.iOS?iOS.callback:void 0}(),native=function(n,a){return invoke?isType("String",n)&&isType("Object",a)?invoke(n,a):void log("native","鏈寜瑕佹眰鎻愪緵鎵€闇€鍙傛暟"):void log("native","褰撳墠闈瀒OS鎴朅ndroid鐜锛宨nvoke鏂规硶涓嶅瓨鍦�")},aliasArray="showToast, getGeoPosition, getIPAddress, getDeviceId, tel, share, pay, navigationBarMenu, setPageTitle, getAccessToken, goback, logout".split(", "),Alias=function(lists){var apiStr="",funcArr=[];return lists.forEach(function(n,a){funcArr[a]=constructFuncStr(n)}),apiStr="var api = {"+funcArr.join(",")+"}",eval(apiStr),api}(aliasArray);return extend({Env:Env,setProtocol:setProtocol,"native":native,callback:callback,appCallBack:callback,_callback:callback},Alias)}}(this,document);